<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN">
  <Properties>
    <Property name="CONSOLE_LOG_PATTERN">%d{HH:mm:ss.SSS} %5p --- [%t] %c : %m%n</Property>
    <Property name="CONSOLE_LOG_CHARSET">UTF-8</Property>
    <Property name="LOKI_LOG_PATTERN">level=%p thread=%t logger=%c message=%m</Property>
    <Property name="LOKI_LOG_CHARSET">UTF-8</Property>
  </Properties>

  <Appenders>
    <Console name="ConsoleAppender" target="SYSTEM_OUT" follow="true">
      <PatternLayout pattern="${CONSOLE_LOG_PATTERN}" charset="${CONSOLE_LOG_CHARSET}"/>
      <Filters>
        <ThresholdFilter level="TRACE"/>
      </Filters>
    </Console>

    <Loki name="Loki">
      <host>${env:LOKI_HOST}</host>
      <port>${env:LOKI_PORT}</port>

      <username>${env:LOKI_USERNAME}</username>
      <password>${env:LOKI_PASSWORD}</password>

      <PatternLayout pattern="${LOKI_LOG_PATTERN}" charset="${LOKI_LOG_CHARSET}"/>

      <Label name="service_name" value="StoreScraperBot"/>
      <Label name="environment" value="${env:ENV}"/>
    </Loki>
  </Appenders>
  <Loggers>
    <Root level="${env:LOG_LEVEL:-debug}">
      <AppenderRef ref="ConsoleAppender"/>
      <AppenderRef ref="Loki"/>
    </Root>
  </Loggers>
</Configuration>
